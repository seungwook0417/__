<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ‘ ì‚¬ëƒ¥</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { box-sizing: border-box; }
    .tab-active {
      background-color: rgb(59 130 246);
      color: white;
    }
    .filter-active {
      background-color: rgb(59 130 246);
      color: white;
    }
    #mapView {
      position: relative;
      background: linear-gradient(to bottom right, #f0f9ff, #e0e7ff);
      border-radius: 0.5rem;
    }
    #mapSvg {
      cursor: grab;
    }
    #mapSvg.dragging {
      cursor: grabbing;
    }
    .map-marker {
      cursor: pointer;
      transition: opacity 0.2s;
    }
    .map-marker:hover {
      opacity: 0.8;
    }
    .map-marker.selected {
      filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.8));
    }
    .map-info-card {
      position: absolute;
      top: 20px;
      right: 20px;
      background: white;
      padding: 16px;
      border-radius: 12px;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      min-width: 280px;
      max-width: 90%;
      display: none;
      border: 2px solid rgb(59 130 246);
    }
    .map-info-card.show {
      display: block;
      animation: slideIn 0.2s ease-out;
    }
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .coord-copy-btn {
      cursor: pointer;
      transition: all 0.2s;
    }
    .coord-copy-btn:hover {
      background-color: rgb(59 130 246);
      color: white;
    }
    .coord-copy-btn:active {
      transform: scale(0.95);
    }
    .zoom-controls {
      position: absolute;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 100;
    }
    .zoom-btn {
      width: 40px;
      height: 40px;
      background: white;
      border: 2px solid rgb(59 130 246);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 20px;
      font-weight: bold;
      color: rgb(59 130 246);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: all 0.2s;
      user-select: none;
    }
    .zoom-btn:hover:not([style*="cursor: default"]) {
      background: rgb(59 130 246);
      color: white;
    }
    .zoom-btn:active:not([style*="cursor: default"]) {
      transform: scale(0.95);
    }
    #zoomLevel {
      min-width: 48px;
      font-family: monospace;
      letter-spacing: 0.5px;
    }
    @media (max-width: 768px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr) !important; }

      /* ëª¨ë°”ì¼ ì»¨í…Œì´ë„ˆ íŒ¨ë”© ì¤„ì´ê¸° */
      .container {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }

      /* ëª¨ë°”ì¼ ì§€ë„ ì»¨í…Œì´ë„ˆ - í™”ë©´ì— ë§ì¶¤ */
      .map-container {
        aspect-ratio: auto !important;
        width: 100% !important;
        height: 400px !important;
        max-height: none !important;
        margin-left: 0;
        margin-right: 0;
      }

      /* ëª¨ë°”ì¼ ì§€ë„ ë·° ì„¹ì…˜ */
      #mapView {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }

      /* ëª¨ë°”ì¼ ì •ë³´ ì¹´ë“œ - ë°”í…€ì‹œíŠ¸ ìŠ¤íƒ€ì¼ */
      .map-info-card {
        top: auto;
        bottom: 0;
        left: 0;
        right: 0;
        transform: none;
        min-width: auto;
        width: 100%;
        max-width: none;
        border-radius: 16px 16px 0 0;
        max-height: 50vh;
        overflow-y: auto;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
      }
      .map-info-card.show {
        animation: slideUpMobile 0.3s ease-out;
      }

      /* ëª¨ë°”ì¼ ì¤Œ ì»¨íŠ¸ë¡¤ - ë” ì‘ê³  íˆ¬ëª…í•˜ê²Œ */
      .zoom-controls {
        bottom: 10px;
        right: 10px;
        gap: 6px;
      }
      .zoom-btn {
        width: 36px;
        height: 36px;
        font-size: 18px;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(8px);
      }
      #zoomLevel {
        min-width: 42px;
        font-size: 11px;
      }

    }
    @keyframes slideUpMobile {
      from {
        opacity: 0;
        transform: translateY(100%);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes slideInMobile {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen font-sans">
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- Header -->
    <header class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">ğŸ‘ ì‚¬ëƒ¥</h1>
      <p class="text-gray-600">ê¸°ì¤€ ì‹œê°: <span id="baseTime">2025-11-09 12:35:10</span> (KST)</p>
      <p class="text-gray-500 text-sm">ì‹¤ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì—…ë°ì´íŠ¸ ì¤‘</p>
    </header>

    <!-- Statistics Dashboard -->
    <div class="grid grid-cols-4 gap-4 mb-6 stats-grid">
      <div class="bg-white rounded-lg shadow-md p-4 text-center">
        <div class="text-3xl font-bold text-blue-600">23</div>
        <div class="text-sm text-gray-600 mt-1">ì „ì²´</div>
      </div>
      <div class="bg-white rounded-lg shadow-md p-4 text-center">
        <div class="text-3xl font-bold text-green-600" id="statActive">12</div>
        <div class="text-sm text-gray-600 mt-1">ë³´í˜¸ë§‰ í™œì„±</div>
      </div>
      <div class="bg-white rounded-lg shadow-md p-4 text-center">
        <div class="text-3xl font-bold text-gray-400" id="statExpired">11</div>
        <div class="text-sm text-gray-600 mt-1">ë§Œë£Œë¨</div>
      </div>
      <div class="bg-white rounded-lg shadow-md p-4 text-center">
        <div class="text-3xl font-bold text-red-600" id="statCritical">0</div>
        <div class="text-sm text-gray-600 mt-1">30ë¶„ ì´í•˜</div>
      </div>
    </div>

    <!-- Filter Controls -->
    <div class="bg-white rounded-lg shadow-md p-4 mb-6">
      <div class="flex flex-wrap gap-3 items-center">
        <div class="flex gap-2 flex-wrap">
          <button onclick="filterRows('all')" class="filter-btn filter-active px-4 py-2 rounded-md bg-gray-200 hover:bg-blue-500 hover:text-white transition" data-filter="all">
            ì „ì²´
          </button>
          <button onclick="filterRows('active')" class="filter-btn px-4 py-2 rounded-md bg-gray-200 hover:bg-blue-500 hover:text-white transition" data-filter="active">
            ë³´í˜¸ë§‰ ìˆìŒ
          </button>
          <button onclick="filterRows('expired')" class="filter-btn px-4 py-2 rounded-md bg-gray-200 hover:bg-blue-500 hover:text-white transition" data-filter="expired">
            ë³´í˜¸ë§‰ ì—†ìŒ
          </button>
          <button onclick="filterRows('critical')" class="filter-btn px-4 py-2 rounded-md bg-gray-200 hover:bg-blue-500 hover:text-white transition" data-filter="critical">
            30ë¶„ ì´í•˜
          </button>
        </div>
        <div class="flex-1 min-w-[200px]">
          <input type="text" id="searchInput" placeholder="ì»¤ë§¨ë” ì´ë¦„ ê²€ìƒ‰..."
                 class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                 oninput="searchCommanders()">
        </div>
      </div>
    </div>

    <!-- View Toggle Tabs -->
    <div class="bg-white rounded-t-lg shadow-md">
      <div class="flex border-b border-gray-200">
        <button onclick="switchView('list')" class="tab-btn tab-active px-6 py-3 font-semibold focus:outline-none" data-view="list">
          ğŸ“‹ ë¦¬ìŠ¤íŠ¸í˜•
        </button>
        <button onclick="switchView('map')" class="tab-btn px-6 py-3 font-semibold focus:outline-none" data-view="map">
          ğŸ—ºï¸ ì§€ë„í˜•
        </button>
      </div>
    </div>

    <!-- List View -->
    <div id="listView" class="bg-white rounded-b-lg shadow-md overflow-hidden">
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-blue-50 text-left sticky top-0">
            <tr>
              <th class="px-6 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider">Commander</th>
              <th class="px-6 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider">ì¢Œí‘œ</th>
              <th class="px-6 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider">ë°©ì–´ë§‰ ì¢…ë£Œ / ë‚¨ì€ì‹œê°„</th>
            </tr>
          </thead>
          <tbody id="commanderTableBody">
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="dr h h holmes í™ˆì¦ˆ" data-x="11" data-y="29">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Dr H H Holmes í™ˆì¦ˆ</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('11, 29')">(11, 29)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="farside ì ˆë§" data-x="253" data-y="41">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Farside ì ˆë§</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('253, 41')">(253, 41)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="nate the citadel" data-x="265" data-y="55">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Nate the citadel</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('265, 55')">(265, 55)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="raisehellpraisedale" data-x="86" data-y="935">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">RaiseHellPraiseDale</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('86, 935')">(86, 935)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="farthobbler" data-x="29" data-y="289">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Farthobbler</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('29, 289')">(29, 289)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="jenna ì œë‚˜" data-x="18" data-y="559">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Jenna ì œë‚˜</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('18, 559')">(18, 559)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="nebula flux" data-x="502" data-y="981">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Nebula Flux</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('502, 981')">(502, 981)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="mm1234567" data-x="980" data-y="81">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">MM1234567</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('980, 81')">(980, 81)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="belle gunness" data-x="998" data-y="931">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Belle Gunness</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('998, 931')">(998, 931)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="brodi32" data-x="357" data-y="909">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Brodi32</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('357, 909')">(357, 909)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="" data-status="expired" data-minutes="-1" data-name="moosienation" data-x="325" data-y="987">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Moosienation</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('325, 987')">(325, 987)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-400">
        <div class="text-xs text-gray-400">ë§Œë£Œ</div>
        <div class="text-gray-400">-</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-gray-400">ì§€ë‚¨</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T13:06:00" data-status="active" data-minutes="31" data-name="ë‹¬ì½¤í•œì±…ë°©sweet" data-x="44" data-y="755">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">ë‹¬ì½¤í•œì±…ë°©Sweet</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('44, 755')">(44, 755)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 01:06</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">31ë¶„ 0ì´ˆ</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T15:35:00" data-status="active" data-minutes="180" data-name="dirkd1ggler" data-x="205" data-y="421">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">DirkD1ggler</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('205, 421')">(205, 421)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 03:35</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">3ì‹œê°„ 0ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T16:40:00" data-status="active" data-minutes="245" data-name="mukkis" data-x="202" data-y="411">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Mukkis</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('202, 411')">(202, 411)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 04:40</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">4ì‹œê°„ 5ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T16:55:00" data-status="active" data-minutes="260" data-name="general z0d" data-x="32" data-y="471">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">General z0d</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('32, 471')">(32, 471)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 04:55</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">4ì‹œê°„ 20ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T17:32:00" data-status="active" data-minutes="297" data-name="dafungi" data-x="266" data-y="53">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Dafungi</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('266, 53')">(266, 53)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 05:32</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">4ì‹œê°„ 57ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T18:32:00" data-status="active" data-minutes="357" data-name="ë‚˜ì´ìˆ˜ì¥" data-x="500" data-y="441">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">ë‚˜ì´ìˆ˜ì¥</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('500, 441')">(500, 441)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 06:32</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">5ì‹œê°„ 57ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T21:30:00" data-status="active" data-minutes="535" data-name="general schwartzkoff" data-x="13" data-y="635">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">General Schwartzkoff</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('13, 635')">(13, 635)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 09:30</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">8ì‹œê°„ 55ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-09T22:41:00" data-status="active" data-minutes="606" data-name="anarchist sheep" data-x="448" data-y="509">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Anarchist Sheep</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('448, 509')">(448, 509)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/09 (ì¼)</div>
        <div>ì˜¤í›„ 10:41</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">10ì‹œê°„ 6ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-10T02:37:00" data-status="active" data-minutes="842" data-name="pemason" data-x="209" data-y="401">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Pemason</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('209, 401')">(209, 401)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/10 (ì›”)</div>
        <div>ì˜¤ì „ 02:37</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">14ì‹œê°„ 2ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-10T04:02:00" data-status="active" data-minutes="927" data-name="icetee58" data-x="233" data-y="409">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">IceTee58</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('233, 409')">(233, 409)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/10 (ì›”)</div>
        <div>ì˜¤ì „ 04:02</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">15ì‹œê°„ 27ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-11T10:29:00" data-status="active" data-minutes="2754" data-name="boneyeric" data-x="940" data-y="765">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">BoneyEric</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('940, 765')">(940, 765)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/11 (í™”)</div>
        <div>ì˜¤ì „ 10:29</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">45ì‹œê°„ 54ë¶„</span>
    </div>
  </td>
</tr>
<tr class="hover:bg-gray-50 commander-row" data-datetime="2025-11-11T10:59:00" data-status="active" data-minutes="2784" data-name="snick ìŠ¤ë‹‰" data-x="217" data-y="409">
  <td class="px-6 py-4 text-sm text-gray-900 font-medium">Snick ìŠ¤ë‹‰</td>
  <td class="px-6 py-4 text-sm text-blue-600 cursor-pointer hover:text-blue-800 hover:underline" onclick="copyCoordinates('217, 409')">(217, 409)</td>
  <td class="px-6 py-4 text-sm">
    <div class="flex items-center justify-between">
      <div class="time-display text-gray-600">
        <div class="text-xs text-gray-500">11/11 (í™”)</div>
        <div>ì˜¤ì „ 10:59</div>
      </div>
      <span class="countdown-display text-xs font-mono ml-4 text-red-600 font-bold">46ì‹œê°„ 24ë¶„</span>
    </div>
  </td>
</tr>
          </tbody>
        </table>
      </div>
      <div id="noResults" class="hidden text-center py-12 text-gray-500">
        ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
      </div>
    </div>

    <!-- Map View -->
    <div id="mapView" class="bg-white rounded-b-lg shadow-md p-6 hidden">
      <div class="mb-4 flex justify-between items-center flex-wrap gap-3">
        <h3 class="text-lg font-semibold text-gray-800">ë¼ìŠ¤íŠ¸ì›Œ ì‹œì¦Œ1 ë§µ (1000x1000)</h3>
        <div class="text-sm text-gray-600">
          <span class="inline-block w-3 h-3 rounded-full bg-green-500 mr-1"></span> í™œì„±
          <span class="inline-block w-3 h-3 rounded-full bg-red-500 ml-3 mr-1"></span> ê¸´ê¸‰
          <span class="inline-block w-3 h-3 rounded-full bg-gray-400 ml-3 mr-1"></span> ë§Œë£Œ
        </div>
      </div>
      <div class="relative border-2 border-gray-300 rounded overflow-hidden map-container" style="aspect-ratio: 1/1; max-height: 700px;">
        <svg id="mapSvg" class="w-full h-full" viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMid meet" style="display: block;">
          <!-- Grid lines -->
          <defs>
            <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">
              <path d="M 100 0 L 0 0 0 100" fill="none" stroke="rgba(0,0,0,0.05)" stroke-width="1"/>
            </pattern>
          </defs>
          <rect width="1000" height="1000" fill="url(#grid)" />

          <!-- Markers will be inserted here -->
          <g id="markers"></g>
        </svg>

        <!-- Zoom Controls -->
        <div class="zoom-controls">
          <div id="zoomLevel" class="zoom-btn" style="font-size: 12px; font-weight: normal; cursor: default; background: rgba(255,255,255,0.95);">Ã—1.0</div>
          <button class="zoom-btn" onclick="zoomIn()" title="í™•ëŒ€">+</button>
          <button class="zoom-btn" onclick="zoomOut()" title="ì¶•ì†Œ">âˆ’</button>
          <button class="zoom-btn" onclick="resetZoom()" title="ì´ˆê¸°í™”" style="font-size: 16px;">âŸ²</button>
        </div>

        <!-- Info Card -->
        <div id="mapInfoCard" class="map-info-card">
          <!-- ëª¨ë°”ì¼ ë°”í…€ì‹œíŠ¸ í•¸ë“¤ -->
          <div class="md:hidden w-12 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>

          <div class="flex justify-between items-start mb-3">
            <h4 class="text-lg font-bold text-gray-800" id="infoName"></h4>
            <button onclick="closeInfoCard()" class="text-gray-400 hover:text-gray-600 text-xl leading-none">&times;</button>
          </div>
          <div class="space-y-2">
            <div class="text-sm text-gray-600">
              <span class="font-semibold">ìƒíƒœ:</span>
              <span id="infoStatus" class="ml-2"></span>
            </div>
            <div id="infoExpireTime" class="text-sm text-gray-600" style="display: none;">
              <span class="font-semibold">ì¢…ë£Œì‹œê°:</span>
              <span id="infoExpireTimeValue" class="ml-2"></span>
            </div>
            <div class="text-sm text-gray-600">
              <span class="font-semibold">ë‚¨ì€ì‹œê°„:</span>
              <span id="infoCountdown" class="ml-2"></span>
            </div>
            <div class="pt-2 border-t border-gray-200">
              <div class="text-xs text-gray-500 mb-1">ì¢Œí‘œ (í´ë¦­í•˜ì—¬ ë³µì‚¬)</div>
              <button id="coordCopyBtn" class="coord-copy-btn w-full px-4 py-2 bg-gray-100 text-gray-800 rounded-md font-mono text-sm font-semibold hover:bg-blue-500 hover:text-white transition">
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script>
    const BASE_TIME = new Date('2025-11-09T12:35:10');
    const MAP_DATA = [{"name": "Dr H H Holmes \ud648\uc988", "x": 11, "y": 29, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Farside \uc808\ub9dd", "x": 253, "y": 41, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Nate the citadel", "x": 265, "y": 55, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "RaiseHellPraiseDale", "x": 86, "y": 935, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Farthobbler", "x": 29, "y": 289, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Jenna \uc81c\ub098", "x": 18, "y": 559, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Nebula Flux", "x": 502, "y": 981, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "MM1234567", "x": 980, "y": 81, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Belle Gunness", "x": 998, "y": 931, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Brodi32", "x": 357, "y": 909, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "Moosienation", "x": 325, "y": 987, "is_expired": true, "total_minutes": -1, "countdown": "\uc9c0\ub0a8", "date_disp": "-", "time_disp": "-"}, {"name": "\ub2ec\ucf64\ud55c\ucc45\ubc29Sweet", "x": 44, "y": 755, "is_expired": false, "total_minutes": 31, "countdown": "31\ubd84 0\ucd08", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 01:06"}, {"name": "DirkD1ggler", "x": 205, "y": 421, "is_expired": false, "total_minutes": 180, "countdown": "3\uc2dc\uac04 0\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 03:35"}, {"name": "Mukkis", "x": 202, "y": 411, "is_expired": false, "total_minutes": 245, "countdown": "4\uc2dc\uac04 5\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 04:40"}, {"name": "General z0d", "x": 32, "y": 471, "is_expired": false, "total_minutes": 260, "countdown": "4\uc2dc\uac04 20\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 04:55"}, {"name": "Dafungi", "x": 266, "y": 53, "is_expired": false, "total_minutes": 297, "countdown": "4\uc2dc\uac04 57\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 05:32"}, {"name": "\ub098\uc774\uc218\uc7a5", "x": 500, "y": 441, "is_expired": false, "total_minutes": 357, "countdown": "5\uc2dc\uac04 57\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 06:32"}, {"name": "General Schwartzkoff", "x": 13, "y": 635, "is_expired": false, "total_minutes": 535, "countdown": "8\uc2dc\uac04 55\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 09:30"}, {"name": "Anarchist Sheep", "x": 448, "y": 509, "is_expired": false, "total_minutes": 606, "countdown": "10\uc2dc\uac04 6\ubd84", "date_disp": "11/09 (\uc77c)", "time_disp": "\uc624\ud6c4 10:41"}, {"name": "Pemason", "x": 209, "y": 401, "is_expired": false, "total_minutes": 842, "countdown": "14\uc2dc\uac04 2\ubd84", "date_disp": "11/10 (\uc6d4)", "time_disp": "\uc624\uc804 02:37"}, {"name": "IceTee58", "x": 233, "y": 409, "is_expired": false, "total_minutes": 927, "countdown": "15\uc2dc\uac04 27\ubd84", "date_disp": "11/10 (\uc6d4)", "time_disp": "\uc624\uc804 04:02"}, {"name": "BoneyEric", "x": 940, "y": 765, "is_expired": false, "total_minutes": 2754, "countdown": "45\uc2dc\uac04 54\ubd84", "date_disp": "11/11 (\ud654)", "time_disp": "\uc624\uc804 10:29"}, {"name": "Snick \uc2a4\ub2c9", "x": 217, "y": 409, "is_expired": false, "total_minutes": 2784, "countdown": "46\uc2dc\uac04 24\ubd84", "date_disp": "11/11 (\ud654)", "time_disp": "\uc624\uc804 10:59"}];
    let currentFilter = 'all';
    let currentView = 'list';

    // ì¤Œ ê´€ë ¨ ë³€ìˆ˜
    let currentZoom = 1;
    let currentPanX = 0;
    let currentPanY = 0;
    let selectedMarker = null;

    // ë“œë˜ê·¸ ê´€ë ¨ ë³€ìˆ˜
    let isDragging = false;
    let dragStartX = 0;
    let dragStartY = 0;
    let dragStartPanX = 0;
    let dragStartPanY = 0;

    // ì¢Œí‘œ ë³µì‚¬
    function copyCoordinates(coords) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(coords).then(function() {
          alert('ì¢Œí‘œ ' + coords + ' ë³µì‚¬ë¨');
        }, function() {
          alert('ë³µì‚¬ ì‹¤íŒ¨');
        });
      } else {
        alert('í´ë¦½ë³´ë“œ ê¶Œí•œ ì—†ìŒ');
      }
    }

    // ë·° ì „í™˜
    function switchView(view) {
      currentView = view;
      const listView = document.getElementById('listView');
      const mapView = document.getElementById('mapView');
      const tabs = document.querySelectorAll('.tab-btn');

      tabs.forEach(tab => {
        if (tab.dataset.view === view) {
          tab.classList.add('tab-active');
        } else {
          tab.classList.remove('tab-active');
        }
      });

      if (view === 'list') {
        listView.classList.remove('hidden');
        mapView.classList.add('hidden');
      } else {
        listView.classList.add('hidden');
        mapView.classList.remove('hidden');
        // ì§€ë„í˜•ìœ¼ë¡œ ì „í™˜ ì‹œì—ë§Œ ë Œë”ë§
        setTimeout(() => renderMap(), 50); // ì•½ê°„ì˜ ë”œë ˆì´ë¡œ ì¤‘ë³µ ë°©ì§€
      }
    }

    // í•„í„° ì ìš©
    function filterRows(filter) {
      currentFilter = filter;
      const rows = document.querySelectorAll('.commander-row');
      const filterBtns = document.querySelectorAll('.filter-btn');
      let visibleCount = 0;

      filterBtns.forEach(btn => {
        if (btn.dataset.filter === filter) {
          btn.classList.add('filter-active');
        } else {
          btn.classList.remove('filter-active');
        }
      });

      rows.forEach(row => {
        const status = row.dataset.status;
        const minutes = parseInt(row.dataset.minutes);
        let show = false;

        if (filter === 'all') show = true;
        else if (filter === 'active') show = status === 'active';
        else if (filter === 'expired') show = status === 'expired';
        else if (filter === 'critical') show = status === 'active' && minutes <= 30;

        if (show) {
          row.style.display = '';
          visibleCount++;
        } else {
          row.style.display = 'none';
        }
      });

      document.getElementById('noResults').classList.toggle('hidden', visibleCount > 0);
      updateStats();
      if (currentView === 'map') renderMap();
    }

    // ê²€ìƒ‰
    function searchCommanders() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const rows = document.querySelectorAll('.commander-row');
      let visibleCount = 0;

      rows.forEach(row => {
        const name = row.dataset.name;
        const matchesSearch = name.includes(searchTerm);
        const status = row.dataset.status;
        const minutes = parseInt(row.dataset.minutes);
        let matchesFilter = false;

        if (currentFilter === 'all') matchesFilter = true;
        else if (currentFilter === 'active') matchesFilter = status === 'active';
        else if (currentFilter === 'expired') matchesFilter = status === 'expired';
        else if (currentFilter === 'critical') matchesFilter = status === 'active' && minutes <= 30;

        if (matchesSearch && matchesFilter) {
          row.style.display = '';
          visibleCount++;
        } else {
          row.style.display = 'none';
        }
      });

      document.getElementById('noResults').classList.toggle('hidden', visibleCount > 0);
      if (currentView === 'map') renderMap();
    }

    // í†µê³„ ì—…ë°ì´íŠ¸
    function updateStats() {
      const rows = document.querySelectorAll('.commander-row');
      let active = 0, expired = 0, critical = 0;

      rows.forEach(row => {
        const status = row.dataset.status;
        const minutes = parseInt(row.dataset.minutes);

        if (status === 'active') {
          active++;
          if (minutes <= 30) critical++;
        } else {
          expired++;
        }
      });

      document.getElementById('statActive').textContent = active;
      document.getElementById('statExpired').textContent = expired;
      document.getElementById('statCritical').textContent = critical;
    }

    // ì¤Œ ë ˆë²¨ í‘œì‹œ ì—…ë°ì´íŠ¸
    function updateZoomDisplay() {
      const zoomLevelEl = document.getElementById('zoomLevel');
      if (zoomLevelEl) {
        zoomLevelEl.textContent = `Ã—${currentZoom.toFixed(1)}`;
        // í™•ëŒ€ ìƒíƒœ ì‹œê°ì  í‘œì‹œ
        if (currentZoom > 1) {
          zoomLevelEl.style.background = 'rgb(59 130 246)';
          zoomLevelEl.style.color = 'white';
          zoomLevelEl.style.fontWeight = 'bold';
        } else {
          zoomLevelEl.style.background = 'rgba(255,255,255,0.95)';
          zoomLevelEl.style.color = 'rgb(59 130 246)';
          zoomLevelEl.style.fontWeight = 'normal';
        }
      }
    }

    // ì¤Œ ê¸°ëŠ¥
    function updateViewBox() {
      const svg = document.getElementById('mapSvg');
      const size = 1000 / currentZoom;
      const x = currentPanX - size / 2;
      const y = currentPanY - size / 2;
      svg.setAttribute('viewBox', `${x} ${y} ${size} ${size}`);
      updateZoomDisplay();
    }

    function zoomIn() {
      if (currentZoom < 5) {
        currentZoom *= 1.5;
        if (currentZoom > 5) currentZoom = 5;
        updateViewBox();
      }
    }

    function zoomOut() {
      if (currentZoom > 1) {
        currentZoom /= 1.5;
        if (currentZoom < 1) currentZoom = 1;
        updateViewBox();
      }
    }

    function resetZoom() {
      currentZoom = 1;
      currentPanX = 500;
      currentPanY = 500;
      updateViewBox();
    }

    // ì •ë³´ ì¹´ë“œ í‘œì‹œ
    function showInfoCard(commander) {
      const infoCard = document.getElementById('mapInfoCard');
      const infoName = document.getElementById('infoName');
      const infoStatus = document.getElementById('infoStatus');
      const infoExpireTime = document.getElementById('infoExpireTime');
      const infoExpireTimeValue = document.getElementById('infoExpireTimeValue');
      const infoCountdown = document.getElementById('infoCountdown');
      const coordCopyBtn = document.getElementById('coordCopyBtn');

      infoName.textContent = commander.name;

      // ìƒíƒœ í‘œì‹œ
      if (commander.is_expired) {
        infoStatus.innerHTML = '<span class="text-gray-500">ğŸ”´ ë§Œë£Œë¨</span>';
        infoExpireTime.style.display = 'none';
      } else if (commander.total_minutes <= 30) {
        infoStatus.innerHTML = '<span class="text-red-600">âš ï¸ ê¸´ê¸‰ (30ë¶„ ì´í•˜)</span>';
        infoExpireTime.style.display = 'block';
        infoExpireTimeValue.textContent = `${commander.date_disp} ${commander.time_disp}`;
      } else {
        infoStatus.innerHTML = '<span class="text-green-600">âœ… í™œì„±</span>';
        infoExpireTime.style.display = 'block';
        infoExpireTimeValue.textContent = `${commander.date_disp} ${commander.time_disp}`;
      }

      infoCountdown.textContent = commander.countdown;

      const coords = `${commander.x}, ${commander.y}`;
      coordCopyBtn.textContent = `(${coords})`;
      coordCopyBtn.onclick = () => {
        copyCoordinates(coords);
        coordCopyBtn.textContent = 'âœ“ ë³µì‚¬ë¨!';
        setTimeout(() => {
          coordCopyBtn.textContent = `(${coords})`;
        }, 1500);
      };

      infoCard.classList.add('show');
    }

    // ì •ë³´ ì¹´ë“œ ë‹«ê¸°
    function closeInfoCard() {
      document.getElementById('mapInfoCard').classList.remove('show');
    }

    // ì§€ë„ ë Œë”ë§ - DOM ë°ì´í„° ê¸°ë°˜ (ì‹¤ì‹œê°„ ë°˜ì˜)
    function renderMap() {
      const markersGroup = document.getElementById('markers');
      if (!markersGroup) return; // ë§ˆì»¤ ê·¸ë£¹ì´ ì—†ìœ¼ë©´ ì¤‘ë‹¨

      const searchTerm = document.getElementById('searchInput').value.toLowerCase();

      // ê¸°ì¡´ ë§ˆì»¤ ì™„ì „íˆ ì œê±° (ì¤‘ë³µ ë°©ì§€)
      while (markersGroup.firstChild) {
        markersGroup.removeChild(markersGroup.firstChild);
      }

      // ì§€ë„ ì¬ë Œë”ë§ ì‹œ ì„ íƒ ì´ˆê¸°í™”
      selectedMarker = null;

      // DOMì˜ row ë°ì´í„°ë¥¼ ì‚¬ìš© (ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” ë°ì´í„°)
      const rows = document.querySelectorAll('.commander-row');

      rows.forEach(row => {
        // DOMì—ì„œ ì‹¤ì‹œê°„ ë°ì´í„° ì½ê¸°
        const name = row.querySelector('td:first-child').textContent.trim();
        const x = parseInt(row.dataset.x);
        const y = parseInt(row.dataset.y);
        const status = row.dataset.status; // 'active' or 'expired'
        const minutes = parseInt(row.dataset.minutes);
        const datetime = row.dataset.datetime;

        // ì¢Œí‘œê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ìŠ¤í‚µ
        if (isNaN(x) || isNaN(y)) return;

        // í•„í„° ì²´í¬
        const matchesSearch = name.toLowerCase().includes(searchTerm);
        let matchesFilter = false;

        if (currentFilter === 'all') matchesFilter = true;
        else if (currentFilter === 'active') matchesFilter = status === 'active';
        else if (currentFilter === 'expired') matchesFilter = status === 'expired';
        else if (currentFilter === 'critical') matchesFilter = status === 'active' && minutes <= 30;

        if (!matchesSearch || !matchesFilter) return;

        // ìƒ‰ìƒ ê²°ì • - ì‹¤ì‹œê°„ ìƒíƒœ ê¸°ë°˜
        let color;
        if (status === 'expired') {
          color = '#9CA3AF'; // gray
        } else if (minutes <= 30) {
          color = '#EF4444'; // red
        } else {
          color = '#10B981'; // green
        }

        // ì¹´ìš´íŠ¸ë‹¤ìš´ í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
        const countdownEl = row.querySelector('.countdown-display');
        const countdown = countdownEl ? countdownEl.textContent : 'ì •ë³´ ì—†ìŒ';

        // ë‚ ì§œ/ì‹œê°„ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        const timeDisplayEl = row.querySelector('.time-display');
        let dateDisp = '-';
        let timeDisp = '-';
        if (timeDisplayEl) {
          const dateEl = timeDisplayEl.querySelector('.text-xs');
          const timeEl = timeDisplayEl.querySelector('div:not(.text-xs)');
          if (dateEl) dateDisp = dateEl.textContent.trim();
          if (timeEl) timeDisp = timeEl.textContent.trim();
        }

        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circle.setAttribute('cx', x);
        circle.setAttribute('cy', 1000 - y); // Yì¶• ë°˜ì „

        // ëª¨ë°”ì¼ì—ì„œ ë§ˆì»¤ í¬ê¸° ì¦ê°€
        const isMobile = window.innerWidth <= 768;
        circle.setAttribute('r', isMobile ? '10' : '8');
        circle.setAttribute('stroke-width', isMobile ? '3' : '2');

        circle.setAttribute('fill', color);
        circle.setAttribute('stroke', 'white');
        circle.classList.add('map-marker');
        circle.dataset.name = name;

        circle.addEventListener('click', (e) => {
          e.stopPropagation();

          // ì´ì „ ì„ íƒëœ ë§ˆì»¤ í•˜ì´ë¼ì´íŠ¸ ì œê±°
          if (selectedMarker) {
            selectedMarker.classList.remove('selected');
          }

          // í˜„ì¬ ë§ˆì»¤ í•˜ì´ë¼ì´íŠ¸
          circle.classList.add('selected');
          selectedMarker = circle;

          // ì‹¤ì‹œê°„ ë°ì´í„°ë¡œ ì •ë³´ ì¹´ë“œ í‘œì‹œ
          const commanderData = {
            name: name,
            x: x,
            y: y,
            is_expired: status === 'expired',
            total_minutes: minutes,
            countdown: countdown,
            date_disp: dateDisp,
            time_disp: timeDisp
          };

          showInfoCard(commanderData);

          // í´ë¦­í•œ ë§ˆì»¤ë¡œ ë¶€ë“œëŸ½ê²Œ ì´ë™ (í™•ëŒ€ ì—†ì´)
          // í™•ëŒ€ëœ ìƒíƒœì¼ ë•Œë§Œ ì„¼í„°ë§
          if (currentZoom > 1) {
            currentPanX = x;
            currentPanY = 1000 - y;
            updateViewBox();
          }
        });

        markersGroup.appendChild(circle);
      });
    }

    // ë§µ ì˜ì—­ í´ë¦­ ì‹œ ì •ë³´ ì¹´ë“œ ë‹«ê¸° ë° ì¤Œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', () => {
      const mapSvg = document.getElementById('mapSvg');
      const mapContainer = mapSvg.parentElement;

      if (mapSvg) {
        let clickTimeout = null;
        let isClick = true;

        mapSvg.addEventListener('mousedown', (e) => {
          // ë§ˆì»¤ í´ë¦­ì´ ì•„ë‹ ë•Œë§Œ ë“œë˜ê·¸ ì‹œì‘
          if (e.target === mapSvg || e.target.tagName === 'rect' || e.target.tagName === 'g') {
            isDragging = true;
            isClick = true;
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            dragStartPanX = currentPanX;
            dragStartPanY = currentPanY;
            mapSvg.classList.add('dragging');
          }
        });

        mapSvg.addEventListener('mousemove', (e) => {
          if (isDragging) {
            isClick = false;
            const rect = mapSvg.getBoundingClientRect();
            const scaleX = 1000 / currentZoom / rect.width;
            const scaleY = 1000 / currentZoom / rect.height;
            const dx = (e.clientX - dragStartX) * scaleX;
            const dy = (e.clientY - dragStartY) * scaleY;

            currentPanX = dragStartPanX - dx;
            currentPanY = dragStartPanY - dy;

            // ë§µ ê²½ê³„ ì œí•œ
            const halfSize = 500 / currentZoom;
            currentPanX = Math.max(halfSize, Math.min(1000 - halfSize, currentPanX));
            currentPanY = Math.max(halfSize, Math.min(1000 - halfSize, currentPanY));

            updateViewBox();
          }
        });

        mapSvg.addEventListener('mouseup', (e) => {
          if (isDragging) {
            isDragging = false;
            mapSvg.classList.remove('dragging');

            // ë“œë˜ê·¸ê°€ ì•„ë‹ˆë¼ í´ë¦­ì´ì—ˆë‹¤ë©´
            if (isClick) {
              closeInfoCard();
              if (selectedMarker) {
                selectedMarker.classList.remove('selected');
                selectedMarker = null;
              }
            }
          }
        });

        mapSvg.addEventListener('mouseleave', () => {
          if (isDragging) {
            isDragging = false;
            mapSvg.classList.remove('dragging');
          }
        });

        // í„°ì¹˜ ë“œë˜ê·¸ ë° í•€ì¹˜ ì¤Œ
        let touchStartForDrag = null;
        let touchStartDistance = 0;
        let touchStartZoom = 1;

        mapContainer.addEventListener('touchstart', (e) => {
          if (e.touches.length === 1) {
            // ë‹¨ì¼ í„°ì¹˜ - ë“œë˜ê·¸
            const touch = e.touches[0];
            if (e.target === mapSvg || e.target.tagName === 'rect' || e.target.tagName === 'g') {
              isDragging = true;
              isClick = true;
              touchStartForDrag = touch;
              dragStartX = touch.clientX;
              dragStartY = touch.clientY;
              dragStartPanX = currentPanX;
              dragStartPanY = currentPanY;
            }
          } else if (e.touches.length === 2) {
            // í•€ì¹˜ ì¤Œ
            isDragging = false;
            const dx = e.touches[0].clientX - e.touches[1].clientX;
            const dy = e.touches[0].clientY - e.touches[1].clientY;
            touchStartDistance = Math.sqrt(dx * dx + dy * dy);
            touchStartZoom = currentZoom;
          }
        });

        mapContainer.addEventListener('touchmove', (e) => {
          if (e.touches.length === 1 && isDragging) {
            // ë‹¨ì¼ í„°ì¹˜ ë“œë˜ê·¸
            e.preventDefault();
            isClick = false;
            const touch = e.touches[0];
            const rect = mapSvg.getBoundingClientRect();
            const scaleX = 1000 / currentZoom / rect.width;
            const scaleY = 1000 / currentZoom / rect.height;
            const dx = (touch.clientX - dragStartX) * scaleX;
            const dy = (touch.clientY - dragStartY) * scaleY;

            currentPanX = dragStartPanX - dx;
            currentPanY = dragStartPanY - dy;

            // ë§µ ê²½ê³„ ì œí•œ
            const halfSize = 500 / currentZoom;
            currentPanX = Math.max(halfSize, Math.min(1000 - halfSize, currentPanX));
            currentPanY = Math.max(halfSize, Math.min(1000 - halfSize, currentPanY));

            updateViewBox();
          } else if (e.touches.length === 2) {
            // í•€ì¹˜ ì¤Œ
            e.preventDefault();
            isDragging = false;
            const dx = e.touches[0].clientX - e.touches[1].clientX;
            const dy = e.touches[0].clientY - e.touches[1].clientY;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const scale = distance / touchStartDistance;
            const newZoom = touchStartZoom * scale;

            if (newZoom >= 1 && newZoom <= 5) {
              currentZoom = newZoom;
              updateViewBox();
            }
          }
        });

        mapContainer.addEventListener('touchend', () => {
          if (isDragging && isClick) {
            // í´ë¦­ìœ¼ë¡œ ê°„ì£¼
            closeInfoCard();
            if (selectedMarker) {
              selectedMarker.classList.remove('selected');
              selectedMarker = null;
            }
          }
          isDragging = false;
        });

        // ë§ˆìš°ìŠ¤ íœ ë¡œ ì¤Œ
        mapContainer.addEventListener('wheel', (e) => {
          e.preventDefault();
          if (e.deltaY < 0) {
            zoomIn();
          } else {
            zoomOut();
          }
        });
      }

      // ì¤Œ ì´ˆê¸°í™”
      currentPanX = 500;
      currentPanY = 500;
      updateZoomDisplay();
    });

    // ì‹¤ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì—…ë°ì´íŠ¸
    function updateCountdowns() {
      const now = new Date();
      const rows = document.querySelectorAll('.commander-row');
      let needsStatsUpdate = false;

      rows.forEach(row => {
        const datetime = row.dataset.datetime;
        if (!datetime) return;

        const expireTime = new Date(datetime);
        const diff = expireTime - now;

        if (diff <= 0) {
          const countdownEl = row.querySelector('.countdown-display');
          if (countdownEl && !countdownEl.classList.contains('text-gray-400')) {
            countdownEl.textContent = 'ë§Œë£Œë¨';
            countdownEl.classList.remove('text-red-600', 'font-bold');
            countdownEl.classList.add('text-gray-400');
            row.dataset.status = 'expired';
            row.dataset.minutes = '-1';
            needsStatsUpdate = true;
          }
        } else {
          const totalMinutes = Math.floor(diff / 1000 / 60);
          const hours = Math.floor(totalMinutes / 60);
          const minutes = totalMinutes % 60;
          const seconds = Math.floor((diff / 1000) % 60);

          // ì´ì „ ê°’ê³¼ ë¹„êµ
          const oldMinutes = parseInt(row.dataset.minutes);
          if (oldMinutes !== totalMinutes) {
            // 30ë¶„ ê²½ê³„ë¥¼ ë„˜ì—ˆëŠ”ì§€ í™•ì¸
            if ((oldMinutes > 30 && totalMinutes <= 30) || (oldMinutes <= 30 && totalMinutes > 30)) {
              needsStatsUpdate = true;
            }
            row.dataset.minutes = totalMinutes;
          }

          const countdownEl = row.querySelector('.countdown-display');
          if (countdownEl) {
            if (hours > 0) {
              countdownEl.textContent = `${hours}ì‹œê°„ ${minutes}ë¶„`;
            } else {
              countdownEl.textContent = `${minutes}ë¶„ ${seconds}ì´ˆ`;
            }
          }
        }
      });

      // í†µê³„ ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‹¤í–‰
      if (needsStatsUpdate) {
        updateStats();
        // ì§€ë„í˜•ì´ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ì§€ë„ë„ ì—…ë°ì´íŠ¸
        if (currentView === 'map') {
          renderMap();
        }
      }
    }

    // 1ì´ˆë§ˆë‹¤ ì¹´ìš´íŠ¸ë‹¤ìš´ ì—…ë°ì´íŠ¸
    setInterval(updateCountdowns, 1000);

    // ì´ˆê¸° ë Œë”ë§
    updateCountdowns();
    updateStats();
  </script>
</body>
</html>
